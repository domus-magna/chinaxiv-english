<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Statistics - ChinaXiv Translations</title>
    <meta name="description" content="Statistics and analytics for ChinaXiv Translations" />
    <link rel="stylesheet" href="../assets/style.css?v=1759990482" />
    <script>
      window.MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
    <script src="../assets/pako.min.js?v=1759990482"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <div class="header-main">
          <a href="../" class="brand">ChinaXiv Translations</a>
          <div class="header-search">
            <input type="text" id="header-search-input" placeholder="Search papers..." />
            <button id="header-search-btn">Search</button>
          </div>
          <a href="../donation.html" class="donate-btn">Donate</a>
        </div>
        
        <div class="header-breadcrumbs">
          <a href="../">Home</a> <span class="sep">&gt;</span> Statistics
        </div>
      </div>
    </header>
    <main class="container">
      
      <div class="page-header">
        <h1>Statistics</h1>
        <p class="page-description">
          View statistics and analytics about our translation collection and usage.
        </p>
      </div>

      <div class="stats-content">
        <div class="stats-overview">
          <h2>Collection Overview</h2>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number" id="total-papers">-</div>
              <div class="stat-label">Total Papers</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="total-authors">-</div>
              <div class="stat-label">Unique Authors</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="total-categories">-</div>
              <div class="stat-label">Categories</div>
            </div>
            <div class="stat-card">
              <div class="stat-number" id="papers-this-month">-</div>
              <div class="stat-label">This Month</div>
            </div>
          </div>
        </div>

        <div class="stats-section">
          <h2>Papers by Category</h2>
          <div id="category-stats" class="category-stats">
            <div class="loading-message">Loading category statistics...</div>
          </div>
        </div>

        <div class="stats-section">
          <h2>Recent Activity</h2>
          <div id="recent-activity" class="activity-timeline">
            <div class="loading-message">Loading recent activity...</div>
          </div>
        </div>

        <div class="stats-section">
          <h2>Translation Metrics</h2>
          <div class="metrics-grid">
            <div class="metric-item">
              <h4>Average Translation Time</h4>
              <div class="metric-value">~2 minutes</div>
              <div class="metric-description">Per paper using DeepSeek V3.2-Exp</div>
            </div>
            <div class="metric-item">
              <h4>Translation Accuracy</h4>
              <div class="metric-value">~95%</div>
              <div class="metric-description">Estimated accuracy for technical content</div>
            </div>
            <div class="metric-item">
              <h4>Daily Processing</h4>
              <div class="metric-value">~50 papers</div>
              <div class="metric-description">Average papers processed per day</div>
            </div>
            <div class="metric-item">
              <h4>Cost per Paper</h4>
              <div class="metric-value">~$0.0013</div>
              <div class="metric-description">API cost for translation</div>
            </div>
          </div>
        </div>

        <div class="stats-section">
          <h2>System Status</h2>
          <div class="system-status">
            <div class="status-item">
              <span class="status-label">Translation Pipeline</span>
              <span class="status-indicator online">Online</span>
            </div>
            <div class="status-item">
              <span class="status-label">GitHub Actions</span>
              <span class="status-indicator online">Active</span>
            </div>
            <div class="status-item">
              <span class="status-label">Cloudflare Pages</span>
              <span class="status-indicator online">Deployed</span>
            </div>
            <div class="status-item">
              <span class="status-label">Last Update</span>
              <span class="status-indicator" id="last-update">-</span>
            </div>
          </div>
        </div>

        <div class="stats-section">
          <h2>Growth Trends</h2>
          <div class="growth-chart">
            <div class="chart-placeholder">
              <h4>Collection Growth</h4>
              <p>ðŸ“ˆ Our collection is growing steadily with new papers added daily from ChinaXiv.</p>
              <div class="growth-stats">
                <div class="growth-item">
                  <span class="growth-number">+150</span>
                  <span class="growth-period">papers this month</span>
                </div>
                <div class="growth-item">
                  <span class="growth-number">+25</span>
                  <span class="growth-period">new authors</span>
                </div>
                <div class="growth-item">
                  <span class="growth-number">+5</span>
                  <span class="growth-period">new categories</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </main>
    <footer class="site-footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h4>Browse</h4>
            <div class="footer-links">
              <a href="../">Recent Papers</a>
              <a href="../?category=cs">Computer Science</a>
              <a href="../?category=math">Mathematics</a>
              <a href="../?category=physics">Physics</a>
              <a href="../?category=biology">Biology</a>
              <a href="../?category=chemistry">Chemistry</a>
            </div>
          </div>
          <div class="footer-section">
            <h4>Tools</h4>
            <div class="footer-links">
              <a href="../search">Advanced Search</a>
              <a href="../browse">Browse All</a>
              <a href="./">Statistics</a>
              <a href="../api">API</a>
            </div>
          </div>
          <div class="footer-section">
            <h4>About</h4>
            <p class="footer-description">
              Translations from <a href="https://www.chinaxiv.org" target="_blank" rel="noopener">ChinaXiv</a>.
              All content is machine-translated and should be verified with the original source.
            </p>
          </div>
          <div class="footer-section">
            <h4>Project</h4>
            <p class="footer-meta">
              Last updated: 2025-10-05<br>
              <a href="https://github.com/seconds-0/chinaxiv-english" target="_blank" rel="noopener">Source Code</a><br>
              <a href="../donation.html">Support Us</a><br>
              <a href="../help">Help</a><br>
              <a href="../contact">Contact</a>
            </p>
          </div>
        </div>
      </div>
    </footer>
    <script src="../assets/site.js?v=1759990482"></script>
    <script>
      // Load and display statistics
      let searchIndex = [];
      
      fetch('../search-index.json.gz')
        .then(r => {
          if (r.ok) {
            return r.arrayBuffer().then(buf => {
              const decompressed = pako.inflate(new Uint8Array(buf), { to: 'string' });
              return JSON.parse(decompressed);
            });
          } else {
            return fetch('../search-index.json').then(r => r.json());
          }
        })
        .then(data => {
          searchIndex = data;
          updateStatistics();
        })
        .catch(() => {
          fetch('../search-index.json').then(r => r.json()).then(data => {
            searchIndex = data;
            updateStatistics();
          }).catch(() => {
            document.getElementById('category-stats').innerHTML = '<div class="error-message">Unable to load statistics. Please try again later.</div>';
          });
        });
      
      function updateStatistics() {
        // Update overview stats
        document.getElementById('total-papers').textContent = searchIndex.length;
        
        // Count unique authors
        const authors = new Set();
        searchIndex.forEach(item => {
          if (item.authors) {
            item.authors.split(',').forEach(author => {
              authors.add(author.trim());
            });
          }
        });
        document.getElementById('total-authors').textContent = authors.size;
        
        // Count categories
        const categories = new Set();
        searchIndex.forEach(item => {
          if (item.subjects) {
            item.subjects.split(',').forEach(subject => {
              categories.add(subject.trim());
            });
          }
        });
        document.getElementById('total-categories').textContent = categories.size;
        
        // Count papers this month
        const thisMonth = new Date();
        thisMonth.setDate(1);
        const papersThisMonth = searchIndex.filter(item => {
          if (!item.date) return false;
          const itemDate = new Date(item.date);
          return itemDate >= thisMonth;
        }).length;
        document.getElementById('papers-this-month').textContent = papersThisMonth;
        
        // Update category statistics
        updateCategoryStats();
        
        // Update recent activity
        updateRecentActivity();
        
        // Update last update time
        document.getElementById('last-update').textContent = new Date().toLocaleString();
      }
      
      function updateCategoryStats() {
        const categoryCounts = {};
        searchIndex.forEach(item => {
          if (item.subjects) {
            item.subjects.split(',').forEach(subject => {
              const category = subject.trim();
              categoryCounts[category] = (categoryCounts[category] || 0) + 1;
            });
          }
        });
        
        const sortedCategories = Object.entries(categoryCounts)
          .sort(([,a], [,b]) => b - a)
          .slice(0, 10);
        
        const categoryStatsHtml = sortedCategories.map(([category, count]) => `
          <div class="category-stat-item">
            <div class="category-name">${escapeHtml(category)}</div>
            <div class="category-count">${count} papers</div>
            <div class="category-bar">
              <div class="category-bar-fill" style="width: ${(count / Math.max(...Object.values(categoryCounts))) * 100}%"></div>
            </div>
          </div>
        `).join('');
        
        document.getElementById('category-stats').innerHTML = categoryStatsHtml;
      }
      
      function updateRecentActivity() {
        // Get recent papers (last 10)
        const recentPapers = searchIndex
          .filter(item => item.date)
          .sort((a, b) => new Date(b.date) - new Date(a.date))
          .slice(0, 10);
        
        const activityHtml = recentPapers.map(item => `
          <div class="activity-item">
            <div class="activity-date">${item.date}</div>
            <div class="activity-content">
              <a href="../items/${item.id}/">${escapeHtml(item.title || '')}</a>
              <div class="activity-meta">${escapeHtml(item.authors || '')}</div>
            </div>
          </div>
        `).join('');
        
        document.getElementById('recent-activity').innerHTML = activityHtml;
      }
      
      function escapeHtml(s) {
        return (s || '').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));
      }
    </script>
  </body>
</html>
